<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>C&lt;DBIx::HTML::PopupRadio&gt; - Convert sql into a popup menu or radio group.</title>
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">Synopsis</a></li>
	<li><a href="#description">Description</a></li>
	<li><a href="#distributions">Distributions</a></li>
	<li><a href="#usage">Usage</a></li>
	<li><a href="#options">Options</a></li>
	<li><a href="#methods">Methods</a></li>
	<li><a href="#sample_code">Sample Code</a></li>
	<li><a href="#see_also">See Also</a></li>
	<li><a href="#author">Author</a></li>
	<li><a href="#copyright">Copyright</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p><code>DBIx::HTML::PopupRadio</code> - Convert sql into a popup menu or radio group.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">Synopsis</a></h1>
<pre>
        use DBIx::HTML::PopupRadio;</pre>
<pre>
        my($popup_object) = DBIx::HTML::PopupRadio -&gt; new
        (
                dbh =&gt; $dbh,
                sql =&gt; 'select campus_id, campus_name from campus order by campus_name',
        );</pre>
<pre>
        $popup_object -&gt; set(default =&gt; '1');</pre>
<pre>
        my($popup_menu)  = $popup_object -&gt; popup_menu();
        my($radio_group) = $popup_object -&gt; radio_group();</pre>
<pre>
        print $popup_menu;</pre>
<p>
</p>
<hr />
<h1><a name="description">Description</a></h1>
<p>This module takes a db handle and an SQL statement, and builds a hash.</p>
<p>Then you ask for that hash in HTML, as a popup menu or as a radio group.</p>
<p>The reading of the db table is delayed until you actually call one of the
methods 'popup_menu' or 'radio_group'. Even then, it is delayed until any
parameters passed in to these 2 methods are processed.</p>
<p>After a call to one of these 2 methods, you can call the 'size' method if
you need to check how many rows were returned by the SQL you used.</p>
<p>Neither the module CGI.pm, nor any of that kidney, are used by this module.
We simply output pure HTML.</p>
<p>
</p>
<hr />
<h1><a name="distributions">Distributions</a></h1>
<p>This module is available both as a Unix-style distro (*.tgz) and an
ActiveState-style distro (*.ppd). The latter is shipped in a *.zip file.</p>
<p>See <a href="http://savage.net.au/Perl-modules/html/installing-a-module.html">http://savage.net.au/Perl-modules/html/installing-a-module.html</a> for
help on unpacking and installing each type of distro.</p>
<p>
</p>
<hr />
<h1><a name="usage">Usage</a></h1>
<p>You create an object of the class by calling the constructor, 'new'.</p>
<p>You then call 'set', if you wish, to set any options.</p>
<p>Now call 'popup_menu' or 'radio_group' to get the HTML.</p>
<p>Lastly, display the HTML as part of a form.</p>
<p>The method names 'popup_menu' and 'radio_group' (and 'param') were chosen to be
reminiscent of methods with the same names in the CGI.pm module. But let
me repeat, my module does not use CGI.</p>
<p>
</p>
<hr />
<h1><a name="options">Options</a></h1>
<p>Here, in alphabetical order, are the options accepted by the constructor,
together with their default values.</p>
<dl>
<dt><strong><a name="item_dbh_%3d%3e_%27%27">dbh =&gt; ''</a></strong><br />
</dt>
<dd>
Pass in an open database handle.
</dd>
<dd>
<p>This option is mandatory, in the call to new, set, popup_menu or radio_group.
Ie By the time you call one of the latter 2 methods, dbh must be set.</p>
</dd>
<p></p>
<dt><strong><a name="item_default_%3d%3e_%27%27">default =&gt; ''</a></strong><br />
</dt>
<dd>
Pass in the string (from SQL column 2) which is to be the default item on the popup
menu or radio group. You supply here the visible menu item, not the value associated with
that menu item.
</dd>
<dd>
<p>If default is not given a value, the first menu item becomes the default.</p>
</dd>
<dd>
<p>See the discussion of the sql option for details about the menu items.</p>
</dd>
<dd>
<p>This option is not mandatory.</p>
</dd>
<p></p>
<dt><strong><a name="item_javascript_%3d%3e_%27%27">javascript =&gt; ''</a></strong><br />
</dt>
<dd>
Pass in a string of JavaScript, eg an event handler.
</dd>
<dd>
<p>By using, say, javascript =&gt; 'onChange = ``replicate()''', you can change the first line of HTML output from this:</p>
</dd>
<dd>
<pre>
        &lt;select id = &quot;field01&quot; name = &quot;field01&quot;&gt;</pre>
</dd>
<dd>
<p>to this:</p>
</dd>
<dd>
<pre>
        &lt;select id = &quot;field01&quot; name = &quot;field01&quot; onChange = &quot;replicate()&quot;&gt;</pre>
</dd>
<dd>
<p>Here is a real sample of such a JavaScript function, which would be output elsewhere in the HTML:</p>
</dd>
<dd>
<pre>
        &lt;script language=&quot;JavaScript&quot;&gt;
        function replicate()
        {
                a_form.field02.value =
                        a_form.field01.options[a_form.field01.selectedIndex].text;</pre>
</dd>
<dd>
<pre>
                a_form.field03.value =
                        a_form.field01.options[a_form.field01.selectedIndex].value;
        }
        &lt;/script&gt;</pre>
</dd>
<dd>
<p>You can see what's happening: The menu item, both visible text and corresponding value returned to your CGI script,
are being copied from the popup menu to 2 other fields in the form.</p>
</dd>
<dd>
<p>Obviously you would replace the body of this function with code of your own choosing.</p>
</dd>
<dd>
<p>Q: Since this is an onChange handler, the 2 other fields will not be initialized until
the default menu selection is changed. So, how do you initialize them before the user selects a new menu item?</p>
</dd>
<dd>
<p>A: By outputting the following Javascript further down the form, after the function, menu and other 2 fields have
been defined:</p>
</dd>
<dd>
<pre>
        &lt;script language=&quot;JavaScript&quot;&gt;replicate();&lt;/script&gt;</pre>
</dd>
<dd>
<p>What's important to note here is that no function is declared, but one is called. The JavaScript is simple executed
inline, at the time it is parsed by the browser.</p>
</dd>
<dd>
<p>This option is not mandatory.</p>
</dd>
<p></p>
<dt><strong><a name="item_linebreak_%3d%3e_0">linebreak =&gt; 0</a></strong><br />
</dt>
<dd>
Pass in 1 if you want each radio group item on a separate line, ie separated
by &lt;br /&gt;s.
</dd>
<dd>
<p>This option is not mandatory.</p>
</dd>
<p></p>
<dt><strong><a name="item_name_%3d%3e_%27dbix_menu%27">name =&gt; 'dbix_menu'</a></strong><br />
</dt>
<dd>
Pass in the name of the form item to use for the popup menu or radio group.
</dd>
<dd>
<p>This option is not mandatory, since it has a default value. It could be unset
and then reset, but must have a value by the time you call popup_menu or
radio_group.</p>
</dd>
<dd>
<p>The value of this parameter is what you will pass into a CGI object when you
call its <a href="#item_param"><code>param()</code></a> method to retrieve the user's selection.</p>
</dd>
<dd>
<p>Hence you would do something like:</p>
</dd>
<dd>
<pre>
        my($name)         = 'fancy_menu';
        my($popup_object) = DBIx::HTML::PopupRadio -&gt; new(name =&gt; $name, ...);
        my($q)            = CGI -&gt; new();
        my($id)           = $q -&gt; param($name) || '';</pre>
</dd>
<p></p>
<dt><strong><a name="item_prompt_%3d%3e_%27%27">prompt =&gt; ''</a></strong><br />
</dt>
<dd>
Alternately, this is possible: prompt =&gt; {'x' =&gt; 'y'}.
</dd>
<dd>
<p>Pass in a prompt to use as the first entry in the popup menu.</p>
</dd>
<dd>
<p>The string, in the first case, can contain a single quote but not a double quote. Eg:
prompt =&gt; ``O'Connor''.</p>
</dd>
<dd>
<p>The key, in the second case, can contain a single quote but not a double quote. Eg:
prompt =&gt; {``'aitch'' =&gt; 'Haitch = ``h'''}.</p>
</dd>
<dd>
<p>Hence we can say new(prompt =&gt; 'Choose one') or new(prompt =&gt; {'0' =&gt; 'Choose one'}).</p>
</dd>
<dd>
<p>In the first case, the string 'Choose one' is both a visible menu item and the value
passed back to the CGI script if the user selects that item.</p>
</dd>
<dd>
<p>In the second case, the string 'Choose one' is the visible menu item, and the other value,
here '0', is the one passed back to the CGI script. In particular, this works -
new(prompt =&gt; {'' =&gt; 'Choose one'}) - to return the empty string to the CGI script.</p>
</dd>
<dd>
<p>This option is not mandatory.</p>
</dd>
<p></p>
<dt><strong><a name="item_sql_%3d%3e_%27%27">sql =&gt; ''</a></strong><br />
</dt>
<dd>
Pass in the SQL used to select the popup menu or radio group items.
</dd>
<dd>
<p>This option is mandatory, in the call to new, set, popup_menu or radio_group.
Ie By the time you call one of the latter 2 methods, sql must be set.</p>
</dd>
<dd>
<p>The SQL must select 2 columns. The first will be used as the value returned by
a CGI object, for example, when you call its <a href="#item_param"><code>param()</code></a> method. The second value
will be used as the visible selection offered to the user on the menu.</p>
</dd>
<dd>
<p>Of course, the 2 columns selected could be the same:</p>
</dd>
<dd>
<pre>
        $obj -&gt; set(sql =&gt; 'select campus_name, campus_name from campus');</pre>
</dd>
<dd>
<p>But normally you would do this:</p>
</dd>
<dd>
<pre>
        $obj -&gt; set(sql =&gt; 'select campus_id, campus_name from campus');</pre>
</dd>
<dd>
<p>This means that the second column is used to construct visible menu items, and
when an item is selected by the user, the first column is what is returned to your
CGI script.</p>
</dd>
<dd>
<p>The question remains: After you do something like this:</p>
</dd>
<dd>
<pre>
        my($q)     = CGI -&gt; new();
        my($id)    = $q -&gt; param('dbxi_menu') || '';</pre>
</dd>
<dd>
<p>how do you convert the value, eg campus_id, back into the visible menu item, eg
campus_name.</p>
</dd>
<dd>
<p>Simple: You call the param method of the DBIx::HTML::PopupRadio class:</p>
</dd>
<dd>
<pre>
        my($name) = $popup_object -&gt; param($id);</pre>
</dd>
<dd>
<p>param returns the empty string if the value of $id is unknown.</p>
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="methods">Methods</a></h1>
<dl>
<dt><strong><a name="item_new">new(%arg): The constructor</a></strong><br />
</dt>
<dd>
See the previous section for details of the parameters.
</dd>
<p></p>
<dt><strong><a name="item_param">param($id): Returns visible menu item corresponding to menu value</a></strong><br />
</dt>
<dd>
Call this to convert the value returned to the CGI script when the user
selected a menu item, into the visible menu item selected by the user.
</dd>
<dd>
<p>In other words, convert the first column of the SQL into the second column.</p>
</dd>
<p></p>
<dt><strong><a name="item_popup_menu">popup_menu(%arg): Return the HTML for a popup menu</a></strong><br />
</dt>
<dd>
<a href="#item_popup_menu"><code>popup_menu(%arg)</code></a> takes the same parameters as new().
</dd>
<p></p>
<dt><strong><a name="item_radio_group">radio_group(%arg): Return the HTML for a radio group</a></strong><br />
</dt>
<dd>
<a href="#item_radio_group"><code>radio_group(%arg)</code></a> takes the same parameters as new().
</dd>
<p></p>
<dt><strong><a name="item_set">set(%arg): Set class member options</a></strong><br />
</dt>
<dd>
Call this to set options after calling new().
</dd>
<dd>
<p><a href="#item_set"><code>set(%arg)</code></a> takes the same parameters as new().</p>
</dd>
<p></p>
<dt><strong><a name="item_size">size(): Return the number of rows returned by your SQL</a></strong><br />
</dt>
<dd>
Call this after calling 'popup_menu' or 'radio_group'.
</dd>
<dd>
<p>It will tell you whether or not your menu is empty.</p>
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="sample_code">Sample Code</a></h1>
<p>See examples/*.cgi for complete programs, both simple and complex.</p>
<p>You will need to run examples/bootstrap-menus.pl to load the 'test'
database, 'campus' and 'unit' tables, with sample data.</p>
<p>You'll have to patch these 2 programs vis-a-vis the db vendor, username
and password.</p>
<p>The sample data in bootstrap-menus.pl is simple, but is used by several
modules, so don't be too keen on changing it :-).</p>
<p>
</p>
<hr />
<h1><a name="see_also">See Also</a></h1>
<pre>
        CGI::Explorer
        DBIx::HTML::ClientDB
        DBIx::HTML::LinkedMenus</pre>
<p>The latter 2 modules will be released after the current one.</p>
<p>
</p>
<hr />
<h1><a name="author">Author</a></h1>
<p><code>DBIx::HTML::PopupRadio</code> was written by Ron Savage <em>&lt;<a href="mailto:ron@savage.net.au">ron@savage.net.au</a>&gt;</em> in 2002.</p>
<p>Home page: <a href="http://savage.net.au/index.html">http://savage.net.au/index.html</a></p>
<p>
</p>
<hr />
<h1><a name="copyright">Copyright</a></h1>
<p>Australian copyright (c) 2002, Ron Savage. All rights reserved.</p>
<pre>
        All Programs of mine are 'OSI Certified Open Source Software';
        you can redistribute them and/or modify them under the terms of
        The Artistic License, a copy of which is available at:
        <a href="http://www.opensource.org/licenses/index.html">http://www.opensource.org/licenses/index.html</a></pre>

</body>

</html>
